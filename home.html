<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Security-Policy" content="frame-ancestors 'self' https://udify.app">
<title>AI 简历</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&family=Rajdhani:wght@300;400;500;600;700&family=Fira+Code:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Source+Han+Sans+CN:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
<script>
tailwind.config = {
theme: {
extend: {
colors: {
primary: '#00F5FF',
secondary: '#9400D3'
}
}
}
}
</script>
<style>
@keyframes circuit {
0% { background-position: 0% 0%; }
100% { background-position: 100% 100%; }
}

@keyframes neuralNet {
0% { transform: scale(1); opacity: 0.8; }
50% { transform: scale(1.1); opacity: 1; }
100% { transform: scale(1); opacity: 0.8; }
}

@keyframes flowingGradient {
0% {
    background-position: 0% 50%;
}
50% {
    background-position: 100% 50%;
}
100% {
    background-position: 0% 50%;
}
}

/* 背景动效 */
body {
background: #0A0A0A;
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
min-height: 100vh;
background-image:
radial-gradient(circle at 50% 50%, rgba(0, 245, 255, 0.1) 0%, transparent 50%),
linear-gradient(rgba(0, 245, 255, 0.05) 1px, transparent 1px),
linear-gradient(90deg, rgba(0, 245, 255, 0.05) 1px, transparent 1px);
background-size: 100% 100%, 20px 20px, 20px 20px;
background-attachment: fixed;
position: relative;
overflow-x: hidden;
overflow-y: auto;
}

body::before {
content: '';
position: absolute;
top: 0;
left: 0;
right: 0;
bottom: 0;
background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h60v60H0z' fill='none'/%3E%3Cpath d='M30 30l15-15M30 30l-15 15M30 30l15 15M30 30l-15-15' stroke='rgba(0,245,255,0.1)' stroke-width='0.5'/%3E%3C/svg%3E");
animation: circuit 20s linear infinite;
pointer-events: none;
}

.neural-node {
position: absolute;
width: 4px;
height: 4px;
background: #00F5FF;
border-radius: 50%;
animation: neuralNet 2s infinite;
}

h1, h2, h3 {
font-family: 'Orbitron', sans-serif;
}

.tech-text {
font-family: 'Fira Code', monospace;
}

/* 视频样式 */
.video-container {
position: relative;
width: 100%;
height: 100vh;
overflow: hidden;
}

.video-container video {
width: 100%;
height: 100%;
object-fit: cover;
}

/* 渐变分割线 */
.gradient-divider {
height: 2px;
background: linear-gradient(90deg, #00F5FF 0%, transparent 100%);
margin: 0.8rem 0 1.8rem 0;
}

/* 简介文字样式调整 */
.intro-text {
font-size: 0.8rem;
font-weight: normal;
line-height: 1.4;
}

@media (min-width: 1024px) {
.intro-text {
    font-size: 0.9rem;
    line-height: 1.5;
}
}

/* AI对话按钮 */
.chat-button {
background: linear-gradient(135deg, #00F5FF 0%, #9400D3 50%, #00F5FF 100%);
background-size: 200% 200%;
animation: flowingGradient 3s ease infinite;
border: none;
border-radius: 8px;
transition: all 0.3s ease;
box-shadow: 0 4px 15px rgba(0, 245, 255, 0.3);
}

.chat-button:hover {
transform: translateY(-2px);
box-shadow: 0 6px 20px rgba(0, 245, 255, 0.5);
}

/* 平行四边形模块 */
.parallelogram-card {
position: relative;
background: transparent;
border: 2px solid #00F5FF;
padding: 1rem 1.5rem;
margin: 0.5rem;
clip-path: polygon(10px 0%, 100% 0%, calc(100% - 10px) 100%, 0% 100%);
transition: all 0.3s ease;
text-decoration: none;
display: flex;
align-items: center;
justify-content: center;
color: white;
}

.parallelogram-card:hover {
background: rgba(0, 245, 255, 0.1);
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(0, 245, 255, 0.3);
color: white;
}

/* 简介中的高亮文本 */
.highlight {
color: #00F5FF;
font-weight: 600;
}

/* AI产品经理字体 */
.youshebiao-font {
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
font-weight: normal;
}

@keyframes circuitFlow {
0% { background-position: 0% 0%, 0% 0%, 0% 0%, 0% 0%; }
100% { background-position: 100% 100%, 100% 100%, 100% 100%, 100% 100%; }
}

@keyframes circuitPulse {
0%, 100% { opacity: 0.3; }
50% { opacity: 0.8; }
}

/* 发光线条系统 */
.content-section {
    position: relative;
}

/* 主连接线 - 名字下方贯穿核心数据模块 */
.main-connection-line {
    position: absolute;
    left: 0;
    width: 100%;
    height: 1px;
    background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(0, 245, 255, 0.8) 20%, 
        rgba(0, 245, 255, 0.8) 80%, 
        transparent 100%);
    box-shadow: 0 0 4px rgba(0, 245, 255, 0.6);
    animation: mainLineFlow 3s ease-in-out infinite;
}

@keyframes mainLineFlow {
    0%, 100% { opacity: 0.8; transform: scaleX(1); }
    50% { opacity: 1; transform: scaleX(1.02); }
}

/* 次级关联线 - 简历下方连接次要信息节点 */
.secondary-connection-line {
    position: absolute;
    left: 10%;
    width: 80%;
    height: 0.8px;
    background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(0, 245, 255, 0.6) 30%, 
        rgba(148, 0, 211, 0.6) 70%, 
        transparent 100%);
    box-shadow: 0 0 3px rgba(0, 245, 255, 0.4);
    animation: secondaryLineFlow 4s ease-in-out infinite reverse;
}

@keyframes secondaryLineFlow {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 0.9; }
}

/* 动态标注线 - 功能下方带角度偏移 */
.annotation-line {
    position: absolute;
    left: 15%;
    width: 70%;
    height: 0.5px;
    background: linear-gradient(105deg, 
        transparent 0%, 
        rgba(0, 245, 255, 0.4) 25%, 
        rgba(148, 0, 211, 0.4) 75%, 
        transparent 100%);
    transform: rotate(15deg) translateY(-2px);
    box-shadow: 0 0 2px rgba(0, 245, 255, 0.3);
    animation: annotationLineFlow 5s linear infinite;
}

@keyframes annotationLineFlow {
    0% { 
        opacity: 0.3; 
        transform: rotate(15deg) translateY(-2px) scaleX(0.8); 
    }
    25% { 
        opacity: 0.7; 
        transform: rotate(15deg) translateY(-2px) scaleX(1.1); 
    }
    50% { 
        opacity: 0.5; 
        transform: rotate(15deg) translateY(-2px) scaleX(0.9); 
    }
    75% { 
        opacity: 0.8; 
        transform: rotate(15deg) translateY(-2px) scaleX(1.05); 
    }
    100% { 
        opacity: 0.3; 
        transform: rotate(15deg) translateY(-2px) scaleX(0.8); 
    }
}

/* 视觉焦点引导 - KPI指标光晕效果 */
.kpi-highlight {
    position: relative;
    display: inline-block;
}

.kpi-highlight::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 40px;
    height: 40px;
    transform: translate(-50%, -50%);
    background: radial-gradient(
        circle,
        rgba(0, 245, 255, 0.4) 0%,
        rgba(0, 245, 255, 0.2) 40%,
        rgba(0, 245, 255, 0.1) 70%,
        transparent 100%
    );
    border-radius: 50%;
    animation: kpiGlow 2s ease-in-out infinite;
    z-index: -1;
}

@keyframes kpiGlow {
    0%, 100% { 
        transform: translate(-50%, -50%) scale(1);
        opacity: 0.6;
    }
    50% { 
        transform: translate(-50%, -50%) scale(1.2);
        opacity: 1;
    }
}

/* 线条连接器 - 视觉连接各个模块 */
.connection-dot {
    position: absolute;
    width: 4px;
    height: 4px;
    background: #00F5FF;
    border-radius: 50%;
    box-shadow: 0 0 8px rgba(0, 245, 255, 0.8);
    animation: dotPulse 2s ease-in-out infinite;
}

@keyframes dotPulse {
    0%, 100% { 
        transform: scale(1);
        opacity: 0.8;
    }
    50% { 
        transform: scale(1.5);
        opacity: 1;
    }
}

/* 移动端隐藏线条 */
@media (max-width: 768px) {
    .main-connection-line,
    .secondary-connection-line,
    .annotation-line {
        display: none;
    }
    
    .kpi-highlight::before {
        width: 30px;
        height: 30px;
    }
}

/* 响应式设计 */
@media (max-width: 768px) {
.main-container {
    flex-direction: column;
}

.video-container {
    height: 50vh;
}

.content-section {
    padding: 2rem 1rem;
}

.feature-grid {
    flex-direction: column;
    gap: 1rem;
}

.parallelogram-card {
    margin: 0.25rem 0;
}

.name-title {
    font-size: 1.75rem !important;
}

.intro-text {
    font-size: 1rem !important;
    font-weight: normal !important;
}
}

@media (max-width: 1024px) and (min-width: 769px) {
#chatModal > div {
    width: 60% !important;
    height: 90vh !important;
}
}

@media (max-width: 1200px) and (min-width: 1025px) {
#chatModal > div {
    width: 45% !important;
    }
}

@media (max-width: 768px) {
    #chatModal {
        justify-content: center !important;
    }
    #chatModal > div {
        width: 100% !important;
        height: 100vh !important;
        margin: 0 !important;
        border-radius: 0 !important;
    }
}

/* 视频Loading状态 */
.video-loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #0A0A0A 0%, #1a1a2e 50%, #16213e 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 10;
    backdrop-filter: blur(2px);
    transition: opacity 0.8s ease-in-out;
}

.loading-text {
    color: #00F5FF;
    font-family: 'Fira Code', monospace;
    font-size: 1.1rem;
    font-weight: 500;
    letter-spacing: 1px;
    text-shadow: 0 0 10px rgba(0, 245, 255, 0.5);
}

.loading-dots {
    color: #00F5FF;
    font-size: 1.1rem;
    font-weight: bold;
}

.loading-dots::after {
    content: '';
    animation: loadingDots 1.5s steps(4, end) infinite;
}

@keyframes loadingDots {
    0% { content: ''; }
    25% { content: '.'; }
    50% { content: '..'; }
    75% { content: '...'; }
    100% { content: ''; }
}

/* 加载进度条 */
.loading-progress {
    width: 200px;
    height: 2px;
    background: rgba(0, 245, 255, 0.2);
    border-radius: 1px;
    margin-top: 20px;
    overflow: hidden;
}

.loading-progress-bar {
    height: 100%;
    background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(0, 245, 255, 0.8) 20%, 
        rgba(0, 245, 255, 1) 50%, 
        rgba(0, 245, 255, 0.8) 80%, 
        transparent 100%);
    width: 40%;
    animation: loadingProgress 2s ease-in-out infinite;
}

@keyframes loadingProgress {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(400%); }
}

/* 档案图标动画 */
.loading-icon {
    font-size: 3rem;
    color: #00F5FF;
    margin-bottom: 1rem;
    animation: iconPulse 2s ease-in-out infinite;
}

@keyframes iconPulse {
    0%, 100% { 
        transform: scale(1);
        opacity: 0.8;
        text-shadow: 0 0 20px rgba(0, 245, 255, 0.5);
    }
    50% { 
        transform: scale(1.1);
        opacity: 1;
        text-shadow: 0 0 30px rgba(0, 245, 255, 0.8);
    }
}

/* 视频淡入效果 */
.video-container video {
    opacity: 0;
    transition: opacity 0.8s ease-in-out;
}

.video-container video.loaded {
    opacity: 1;
}

/* 移动端图片备选方案 */
.mobile-avatar-fallback {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 0;
}

/* 移动端播放提示 */
.mobile-play-hint {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 15;
    text-align: center;
    color: #00F5FF;
    cursor: pointer;
    transition: all 0.3s ease;
}

.mobile-play-hint:hover {
    transform: translate(-50%, -50%) scale(1.1);
}

.play-icon {
    font-size: 4rem;
    margin-bottom: 0.5rem;
    text-shadow: 0 0 20px rgba(0, 245, 255, 0.8);
    animation: playIconPulse 2s ease-in-out infinite;
}

.play-text {
    font-size: 1rem;
    font-weight: 500;
    text-shadow: 0 0 10px rgba(0, 245, 255, 0.5);
}

@keyframes playIconPulse {
    0%, 100% { 
        opacity: 0.8;
        transform: scale(1);
    }
    50% { 
        opacity: 1;
        transform: scale(1.1);
    }
}

/* 移动端调整 */
@media (max-width: 768px) {
    .loading-text {
        font-size: 1rem;
    }
    
    .loading-icon {
        font-size: 2.5rem;
    }
    
    .loading-progress {
        width: 150px;
    }
    
    .video-container {
        height: 50vh;
        min-height: 300px;
    }
    
    .play-icon {
        font-size: 3rem;
    }
    
    .play-text {
        font-size: 0.9rem;
    }
}
</style>
<script>
window.difyChatbotConfig = {
    token: '59tnkCD2flttXQHd',
    isDev: false,
    baseUrl: 'https://udify.app',
    containerProps: {
        style: {
            width: '100%',
            height: '100%',
            minHeight: '700px'
        }
    }
};
</script>
<script src="https://udify.app/embed.js"></script>
</head>
<body class="min-h-screen text-white" id="mainBody">

<!-- 背景装饰节点 -->
<div class="neural-node" style="top:10%; left:20%;"></div>
<div class="neural-node" style="top:30%; left:80%;"></div>
<div class="neural-node" style="top:70%; left:15%;"></div>
<div class="neural-node" style="top:85%; left:75%;"></div>
<div class="neural-node" style="top:50%; left:50%;"></div>

<!-- 主要内容区域 -->
<div class="min-h-screen flex flex-col lg:flex-row main-container">
    <!-- 左侧视频区域 -->
    <div class="lg:w-1/2 video-container">
        <!-- Loading状态覆盖层 -->
        <div class="video-loading-overlay" id="videoLoading">
            <div class="loading-icon">
                <i class="fas fa-folder-open"></i>
            </div>
            <div class="loading-text">
                [档案加载中<span class="loading-dots"></span>]
            </div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
        <!-- 视频元素 -->
        <video autoplay muted loop playsinline id="avatarVideo" poster="avatar.JPG">
            <source src="avatar.mp4" type="video/mp4">
            您的浏览器不支持视频播放。
        </video>
        
        <!-- 移动端图片备选方案 -->
        <img src="avatar.JPG" alt="范玉婷 AI产品经理" id="mobileAvatar" class="mobile-avatar-fallback" style="display: none;">
        
        <!-- 点击播放提示（移动端） -->
        <div class="mobile-play-hint" id="mobilePlayHint" style="display: none;">
            <div class="play-icon">
                <i class="fas fa-play-circle"></i>
            </div>
            <div class="play-text">点击播放视频</div>
        </div>
    </div>

    <!-- 右侧内容区域 -->
    <div class="lg:w-1/2 content-section flex flex-col justify-center p-8 lg:p-12">
        <!-- 姓名和职位 -->
        <div class="mb-6 relative">
                         <h1 class="name-title text-3xl lg:text-4xl font-bold mb-2">
                 <span class="text-primary">范玉婷</span>
                 <span class="text-white">/<span class="youshebiao-font">AI产品经理</span></span>
             </h1>
             <!-- 主连接线 - 名字下方 -->
             <div class="main-connection-line" style="top: 100%; margin-top: 8px;"></div>
             <!-- 连接点 -->
             <div class="connection-dot" style="right: 20%; top: 100%; margin-top: 6px;"></div>
</div>

                 <!-- 简介 -->
         <div class="mb-6 intro-text relative">
             <p class="mb-2">
                 资深AI产品：4年AI产品设计，设计的LLM应用开发平台，斩获行业<span class="highlight kpi-highlight">首个百万</span>大模型订单；主导0-1打造<span class="highlight kpi-highlight">300万</span>用户小程序及多个企业级AI平台；
             </p>
             <p>
                复杂系统架构：擅长构建企业级低代码后台，缩短AI应用开发周期。
            </p>
             <p class="mb-2">
                 AI云服务商业化：累计为<span class="highlight kpi-highlight">250+</span>教育/打印机/互联网等行业客户提供AI云服务，单API日调用量<span class="highlight kpi-highlight">10万+</span>；
             </p>
             
             <!-- 次级关联线 - 简历下方 -->
             <div class="secondary-connection-line" style="top: 100%; margin-top: 12px;"></div>
             <!-- 连接点 -->
             <div class="connection-dot" style="left: 25%; top: 100%; margin-top: 10px;"></div>
</div>
<br>

        <!-- 渐变分割线 -->
        <!-- <div class="gradient-divider"></div> -->

        <!-- AI对话按钮 -->
        <button onclick="openChat()" class="chat-button w-full py-4 px-6 text-white font-semibold text-lg mb-8 flex items-center justify-center">
            <i class="fas fa-robot mr-3 text-xl"></i>
            和我AI对话
        </button>

                 <!-- 功能模块 -->
         <div class="feature-grid flex flex-col lg:flex-row gap-4 relative">
             <a href="detail.html?section=experience" class="parallelogram-card flex-1">
                 <i class="fas fa-briefcase mr-2 text-primary"></i>
                 <span class="text-white font-semibold">工作经历</span>
</a>
             <a href="detail.html?section=projects" class="parallelogram-card  flex-1">
                 <i class="fas fa-rocket mr-2 text-primary"></i>
                 <span class="text-white font-semibold">项目案例</span>
</a>
             <a href="detail.html?section=portfolio" class="parallelogram-card  flex-1">
                 <i class="fas fa-star mr-2 text-primary"></i>
                 <span class="text-white font-semibold">作品集</span>
</a>
             <!-- 动态标注线 - 功能下方 -->
             <div class="annotation-line" style="top: 100%; margin-top: 16px;"></div>
             <!-- 连接点 -->
             <div class="connection-dot" style="right: 30%; top: 100%; margin-top: 12px;"></div>
</div>
</div>
</div>

<!-- 底部信息 -->
<div class="w-full py-8 border-t border-primary/20 bg-black/20">
          <div class="max-w-[1200px] mx-auto px-6 text-center">
        <div class="text-gray-400 text-sm">
            <p>和我的AI队友一起捣鼓出了我的AI简历和其他几个小项目;<br>虽然还不够精致，但在反复调试中慢慢进步着。<br>团队里有AI设计师MasterGo、即梦，AI工程师Cursor，还有AI助理Dify和Coze;<br>以及一群强力智囊团：持续输出的Claude、DeepSeek、Gemini、豆包、文心一言</p>
            </div>
        <div class="mt-4 text-gray-400 text-sm">
            <p>© vanyima 2025</p>
        </div>
    </div>
</div>

<!-- 聊天对话框 -->
<div id="chatModal" class="fixed inset-0 bg-black/80 hidden items-center justify-end z-50" onclick="closeChat(event)">
    <div class="bg-black/90 w-1/3 h-[90vh] rounded-lg border border-primary relative md:mr-8 my-[5vh]" onclick="event.stopPropagation()">
        <button onclick="closeChat()" class="absolute top-4 right-4 text-white hover:text-primary">
            <i class="fas fa-times text-2xl"></i>
        </button>
        <div class="w-full h-full overflow-hidden">
            <iframe
                src="https://udify.app/chatbot/dXOGs4pTdPO0BPmY"
                style="width: 100%; height: 100%"
                frameborder="0"
                allow="microphone">
            </iframe>
        </div>
    </div>
</div>

<script>
// 数据埋点系统
class Analytics {
    constructor() {
        this.apiUrl = '/api/analytics';
        this.sessionId = this.generateSessionId();
        this.init();
    }

    generateSessionId() {
        return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    }

    init() {
        // 记录页面访问
        this.trackPageView();
        
        // 绑定点击事件
        this.bindClickEvents();
    }

    // 记录页面浏览量
    trackPageView() {
        const data = {
            event: 'page_view',
            page: 'home',
            timestamp: new Date().toISOString(),
            sessionId: this.sessionId,
            userAgent: navigator.userAgent,
            referrer: document.referrer
        };
        
        this.sendData(data);
        console.log('页面浏览记录:', data);
    }

    // 记录点击事件
    trackClick(element, action) {
        const data = {
            event: 'click',
            action: action,
            element: element,
            timestamp: new Date().toISOString(),
            sessionId: this.sessionId
        };
        
        this.sendData(data);
        console.log('点击记录:', data);
    }

    // 绑定所有需要追踪的点击事件
    bindClickEvents() {
        // AI对话按钮
        const chatButton = document.querySelector('[onclick="openChat()"]');
        if (chatButton) {
            chatButton.addEventListener('click', () => {
                this.trackClick('chat_button', 'chat_button');
            });
        }

        // 功能模块点击
        const moduleLinks = document.querySelectorAll('.parallelogram-card');
        moduleLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                const href = link.getAttribute('href');
                let moduleName = 'unknown';
                
                if (href.includes('experience')) {
                    moduleName = 'work_experience';
                } else if (href.includes('projects')) {
                    moduleName = 'projects';
                } else if (href.includes('portfolio')) {
                    moduleName = 'portfolio';
                }
                
                this.trackClick('module_link', moduleName);
            });
        });
    }

    // 发送数据到后端
    async sendData(data) {
        try {
            const response = await fetch(this.apiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            });
            
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const result = await response.json();
            console.log('数据发送成功:', result);
        } catch (error) {
            console.error('数据发送失败:', error);
            // 发送失败时可以考虑存储到localStorage作为备份
        }
    }

    // 获取指定日期的数据统计
    async getAnalytics(date) {
        try {
            const response = await fetch(`${this.apiUrl}/${date}`);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const stats = await response.json();
            return stats;
        } catch (error) {
            console.error('获取数据失败:', error);
            return null;
        }
    }

    // 获取一段时间内的数据
    async getAnalyticsRange(startDate, endDate) {
        try {
            const response = await fetch(`${this.apiUrl}/range/${startDate}/${endDate}`);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const results = await response.json();
            return results;
        } catch (error) {
            console.error('获取范围数据失败:', error);
            return null;
        }
    }

    // 显示今天的统计数据
    async showTodayStats() {
        const today = new Date().toISOString().split('T')[0];
        const stats = await this.getAnalytics(today);
        if (stats) {
            console.table(stats);
        }
        return stats;
    }

    // 获取所有数据
    async getAllAnalytics() {
        try {
            const response = await fetch(this.apiUrl);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const results = await response.json();
            return results;
        } catch (error) {
            console.error('获取所有数据失败:', error);
            return null;
        }
    }
}

// 初始化分析系统
const analytics = new Analytics();

// 将analytics对象暴露到全局，方便调试
window.analytics = analytics;

// 检测设备类型
function isMobileDevice() {
    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth <= 768;
}

// 视频加载控制
function initVideoLoading() {
    const video = document.getElementById('avatarVideo');
    const loadingOverlay = document.getElementById('videoLoading');
    const mobileAvatar = document.getElementById('mobileAvatar');
    const mobilePlayHint = document.getElementById('mobilePlayHint');
    const isMobile = isMobileDevice();
    
    console.log('设备类型:', isMobile ? '移动端' : '桌面端');
    
    if (video && loadingOverlay) {
        // 移动端特殊处理
        if (isMobile) {
            console.log('移动端：使用图片替代视频');
            // 移动端隐藏视频，直接显示图片
            video.style.display = 'none';
            
            setTimeout(() => {
                loadingOverlay.style.opacity = '0';
                setTimeout(() => {
                    loadingOverlay.style.display = 'none';
                    mobileAvatar.style.display = 'block';
                    mobileAvatar.style.opacity = '0';
                    setTimeout(() => {
                        mobileAvatar.style.transition = 'opacity 0.8s ease-in-out';
                        mobileAvatar.style.opacity = '1';
                    }, 100);
                }, 800);
            }, 1500); // 移动端稍微快一点显示
            
            // 添加点击播放视频的功能
            mobileAvatar.addEventListener('click', function() {
                mobilePlayHint.style.display = 'block';
                setTimeout(() => {
                    mobilePlayHint.style.opacity = '1';
                }, 100);
            });
            
            mobilePlayHint.addEventListener('click', function() {
                video.style.display = 'block';
                video.play().then(() => {
                    mobileAvatar.style.display = 'none';
                    mobilePlayHint.style.display = 'none';
                    video.classList.add('loaded');
                }).catch(err => {
                    console.log('视频播放失败:', err);
                    alert('视频播放失败，请检查网络连接');
                });
            });
            
        } else {
            // 桌面端正常视频加载
            video.addEventListener('loadeddata', function() {
                console.log('视频加载成功');
                setTimeout(() => {
                    loadingOverlay.style.opacity = '0';
                    video.classList.add('loaded');
                    setTimeout(() => {
                        loadingOverlay.style.display = 'none';
                    }, 800);
                }, 1000);
            });
            
            video.addEventListener('error', function() {
                console.log('视频加载失败，显示备用图片');
                loadingOverlay.style.display = 'none';
                mobileAvatar.style.display = 'block';
                mobileAvatar.style.opacity = '1';
            });
            
            // 超时处理
            setTimeout(() => {
                if (video.readyState < 3) {
                    console.log('视频加载超时，切换到图片');
                    loadingOverlay.style.display = 'none';
                    mobileAvatar.style.display = 'block';
                    mobileAvatar.style.opacity = '1';
                }
            }, 8000); // 桌面端超时时间稍长
        }
    }
}

function openChat() {
    document.getElementById('chatModal').classList.remove('hidden');
    document.getElementById('chatModal').classList.add('flex');
}

function closeChat(event) {
    if (event) {
        event.stopPropagation();
    }
    document.getElementById('chatModal').classList.add('hidden');
    document.getElementById('chatModal').classList.remove('flex');
}

// 网络状态检测
function getNetworkInfo() {
    if ('connection' in navigator) {
        const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
        return {
            effectiveType: connection.effectiveType,
            downlink: connection.downlink,
            saveData: connection.saveData
        };
    }
    return null;
}

document.addEventListener('DOMContentLoaded', function() {
    console.log('页面加载完成');
    
    // 检测网络状况
    const networkInfo = getNetworkInfo();
    if (networkInfo) {
        console.log('网络信息:', networkInfo);
        
        // 如果是慢速网络，优先使用图片
        if (networkInfo.effectiveType === '2g' || networkInfo.effectiveType === 'slow-2g' || networkInfo.saveData) {
            console.log('检测到慢速网络，优化加载策略');
            const video = document.getElementById('avatarVideo');
            const mobileAvatar = document.getElementById('mobileAvatar');
            const loadingOverlay = document.getElementById('videoLoading');
            
            // 强制使用图片模式
            setTimeout(() => {
                loadingOverlay.style.display = 'none';
                mobileAvatar.style.display = 'block';
                mobileAvatar.style.opacity = '1';
                video.style.display = 'none';
            }, 1000);
        }
    }
    
    // 初始化视频加载控制
    initVideoLoading();
    
    // 显示使用说明
    console.log(`
📱 移动端优化说明：
• 自动检测移动设备，优先显示图片
• 检测网络状况，慢速网络自动切换图片模式
• 支持点击图片播放视频（需用户交互）
• 视频加载失败自动降级到图片显示
• 大幅提升移动端加载速度
    `);
});
</script>

</body>
</html>